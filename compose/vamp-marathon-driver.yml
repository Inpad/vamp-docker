zookeeper:
  image: magneticio/vamp-zookeeper:${VAMP_VERSION}
  container_name: vamp-zookeeper
  ports:
    - "2181:2181"

mesos-master:
  image: magneticio/vamp-mesos:${VAMP_VERSION}
  container_name: vamp-mesos-master
  command: mesos-master
  ports:
    - "5050:5050"
  links:
   - zookeeper
  environment:
    MESOS_CLUSTER: magneticio/mesos
    MESOS_HOSTNAME: 192.168.59.103
    MESOS_WORK_DIR: /var/lib/mesos
    MESOS_LOG_DIR: /var/log
    MESOS_QUORUM: 1
    MESOS_ZK: zk://zookeeper:2181/mesos

mesos-slave1:
  image: magneticio/vamp-mesos:${VAMP_VERSION}
  container_name: vamp-mesos-slave1
  command: supervisord -n
  privileged: true
  links:
    - zookeeper
    - mesos-master
  ports:
    - "5051:5051"
  environment:
    MESOS_CONTAINERIZERS: "docker,mesos"
    MESOS_EXECUTOR_REGISTRATION_TIMEOUT: "10mins"
    MESOS_HOSTNAME: mesos-master
    MESOS_MASTER: zk://zookeeper:2181/mesos

mesos-slave2:
  image: magneticio/vamp-mesos:${VAMP_VERSION}
  container_name: vamp-mesos-slave2
  command: supervisord -n
  privileged: true
  links:
    - zookeeper
    - mesos-master
  ports:
    - "5052:5052"
  environment:
    MESOS_CONTAINERIZERS: "docker,mesos"
    MESOS_EXECUTOR_REGISTRATION_TIMEOUT: "10mins"
    MESOS_HOSTNAME: mesos-master
    MESOS_MASTER: zk://zookeeper:2181/mesos
    MESOS_PORT: "5052"

marathon:
  image: magneticio/vamp-marathon:${VAMP_VERSION}
  container_name: vamp-marathon
  ports:
    - "8080:8080"
  links:
    - zookeeper
  command: "--master zk://zookeeper:2181/mesos --zk zk://zookeeper:2181/marathon"

elasticsearch:
  image: magneticio/vamp-elasticsearch:${VAMP_VERSION}
  container_name: vamp-elasticsearch
  command: elasticsearch -Des.network.host=0.0.0.0
  ports:
    - "9200:9200"

logstash:
  image: magneticio/vamp-logstash:${VAMP_VERSION}
  container_name: vamp-logstash
  command: logstash -f /etc/logstash/conf.d/logstash.conf
  volumes:
    - ../logstash/logstash.conf:/etc/logstash/conf.d/logstash.conf
  ports:
    - "10001:10001/udp"
  links:
    - elasticsearch

kibana:
  image: magneticio/vamp-kibana:${VAMP_VERSION}
  container_name: vamp-kibana
  volumes:
    - ../kibana/kibana.yml:/opt/kibana/config/kibana.yml
  ports:
    - "5601:5601"
  links:
    - elasticsearch

vamp-gateway-agent:
  image: magneticio/vamp-gateway-agent_1.5.14-ubuntu-14.04:${VAMP_VERSION}
  container_name: vamp-gateway-agent
  command: "-zooKeeperServers=zookeeper:2181 -logstashHost=logstash"
  links:
    - zookeeper
    - logstash
  ports:
    - "1988:1988"
    - "9050:9050"
    - "9051:9051"
    - "9052:9052"
    - "9053:9053"
    - "9054:9054"
    - "9055:9055"
    - "33000:33000"
    - "33001:33001"
    - "33002:33002"
    - "33003:33003"
    - "33004:33004"
    - "33005:33005"
